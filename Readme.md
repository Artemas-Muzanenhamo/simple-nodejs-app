# NodeJS

## Node.js Building Blocks

Node is comprised of 3 building blocks at a high level.

- Libuv - A high perfomance, cross-platform event I/O library.
- V8 - Google's JS engine(also used in Chrome).
- js, C++

## Getting Node.js

* You can download Node [Here](https://nodejs.org/en/download/).
* Should you want to have the source code, you can also look/download it [here](https://github.com/nodejs/node).
* Because it's a bit of a pain to keep up with the Node.js versions, you can use
the tool NVM which manages the versioning with Node.js. You can get it from [here](https://github.com/creationix/nvm).

## Node Event Loop

* In the browser the `event loop` is constantly listening to DOM events such as key presses or mouse clicks.
* On the server the `event loop` is constantly listening to events. 
    * These events can be externally generated such as incoming HTTP or TCP requests.
    * Timers or other internal events generated by your node application.
    * Other events may be triggered on the response to a request against an external resource.
        * E.g asking Node to open up a file for reading.
        * Or fire an event when the file is open and ready.
        * Sending a message to an external process.
        * Or firing an event when a process if finished.
        * Making a request to another server.

## Writing asynchronous code is different
### A typical approach

```javascript
var conn = getDbConnection(connectionString); 
var stmt = conn.createStatement();
var results = stmt.executeQuery(sqlQuery); 
for (var i=0; i<results.length; i++) {
      // print results[i];
    }
```
### An asynchronous, “non-blocking” approach

```javascript
getDbConnection(connectionString, function(err, conn) {
    conn.createStatement(function(err, stmt) {
        var results = stmt.executeQuery(sqlQuery); 
        results.on(‘row’, function(result) {
            // print result
        });
    });
});
```

## Coding for asynchrony with callbacks
### Asynchronous functions with callbacks

Error is the first parameter to callback function:
```javascript
var handleResults = function(error, results) {
  // if error is undefined...
  // do something with the results
}
```
Callback is the last parameter in async function call:
```javascript
getStuff(inputParam, handleResults);
```